global:
  provider: "GoogleCloud"

  serviceAccount:
    create: false
    name: "bucket-service-account"

  configuration:
    swaggerUi:
      tokenUrl: "https://bkb-nmshd-preprod.nbpdev.de/connect/token"
    infrastructure:
      eventBus:
        vendor: RabbitMQ
        connectionInfo: "rabbitmq"
        rabbitMQUsername: "admin"
    modules:
      challenges:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
      devices:
        application:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          pushNotifications:
            provider: "Dummy"
            azureNotificationHub:
              hubName: "a"
              connectionString: "a"
      files:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          blobStorage:
            cloudProvider: "GoogleCloud"
            # ContainerName - see https://bildungsraum.de/display/DEV/Google+Cloud+Storage
            containerName: "bkt-prj-nbp-preprod-infra-5bf4-nmshd-bkb-files"
      messages:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          blobStorage:
            cloudProvider: "GoogleCloud"
            # ContainerName - see https://bildungsraum.de/display/DEV/Google+Cloud+Storage
            containerName: "bkt-prj-nbp-preprod-infra-5bf4-nmshd-bkb-messages"
      relationships:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          blobStorage:
            cloudProvider: "GoogleCloud"
            # ContainerName - see https://bildungsraum.de/display/DEV/Google+Cloud+Storage
            containerName: "bkt-prj-nbp-preprod-infra-5bf4-nmshd-bkb-relationships"
      synchronization:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          blobStorage:
            cloudProvider: "GoogleCloud"
            # ContainerName - see https://bildungsraum.de/display/DEV/Google+Cloud+Storage
            containerName: "bkt-prj-nbp-preprod-infra-5bf4-nmshd-bkb-synchronization"
      tokens:
        infrastructure:
          sqlDatabase:
            provider: "Postgres"
          blobStorage:
            cloudProvider: "GoogleCloud"
            # ContainerName - see https://bildungsraum.de/display/DEV/Google+Cloud+Storage
            containerName: "bkt-prj-nbp-preprod-infra-5bf4-nmshd-bkb-tokens"

consumerapi:
  # httpRoute - see https://bildungsraum.de/display/DEV/Google+Kubernetes+Engine#GoogleKubernetesEngine-3.2HowmakeyourServiceaccessible
  httpRoute:
    enabled: true
    parentRefName: "public-gateway"
    parentRefNamespace: "default"
    hostnames: ["bkb-nmshd-preprod.nbpdev.de"]
  env:
    - name: authentication__jwtSigningCertificate
      valueFrom:
        secretKeyRef:
          name: "jwt-signing-certificate"
          key: "VALUE"
    - name: modules__challenges__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "challenges-sql-connectionstring"
          key: "VALUE"
    - name: modules__devices__infrastructure__azureNotificationHub__connectionString
      valueFrom:
        secretKeyRef:
          name: "devices-notificationhub-connectionstring"
          key: "VALUE"
    - name: modules__devices__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "devices-sql-connectionstring"
          key: "VALUE"
    - name: modules__files__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "files-sql-connectionstring"
          key: "VALUE"
    - name: modules__messages__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "messages-sql-connectionstring"
          key: "VALUE"
    - name: modules__relationships__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "relationships-sql-connectionstring"
          key: "VALUE"
    - name: modules__synchronization__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "synchronization-sql-connectionstring"
          key: "VALUE"
    - name: modules__tokens__infrastructure__sqlDatabase__connectionString
      valueFrom:
        secretKeyRef:
          name: "tokens-sql-connectionstring"
          key: "VALUE"

admincli:
  env:
    - name: Database__connectionString
      valueFrom:
        secretKeyRef:
          name: "devices-sql-connectionstring"
          key: "VALUE"

ephemeral: true # TODO: use it to deploy ephemeral postgres

rabbitmq:
  create: true
